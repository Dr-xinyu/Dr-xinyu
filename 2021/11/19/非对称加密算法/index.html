<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>非对称加密算法 | 心雨</title><meta name="description" content="密码学的学习"><meta name="keywords" content="学习,密码学,非对称加密算法,RSA算法"><meta name="author" content="Dr-xinyu"><meta name="copyright" content="Dr-xinyu"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="非对称加密算法"><meta name="twitter:description" content="密码学的学习"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><meta property="og:type" content="article"><meta property="og:title" content="非对称加密算法"><meta property="og:url" content="https://dr-xinyu.github.io/2021/11/19/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/"><meta property="og:site_name" content="心雨"><meta property="og:description" content="密码学的学习"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://dr-xinyu.github.io/2021/11/19/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/"><link rel="next" title="南京之旅" href="https://dr-xinyu.github.io/2021/04/26/%E5%8D%97%E4%BA%AC/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'false',
  highlight_lang: 'true',
  highlight_shrink: 'false',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  copyright: undefined,
  copy_copyright_js: false,
  ClickShowText: undefined,
  medium_zoom: 'false',
  Snackbar: undefined
  
}</script></head><body><div id="header"> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">心雨</a></span><i class="fa fa-bars fa-fw toggle-menu pull_right close" aria-hidden="true"></i><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></span><span class="pull_right" id="search_button"></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lazyload avatar_img" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">19</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">22</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">10</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#非对称加密算法"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">非对称加密算法</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#原理"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">原理</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#对称加密算法"><span class="toc_mobile_items-number">1.1.1.</span> <span class="toc_mobile_items-text">对称加密算法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#非对称加密算法-1"><span class="toc_mobile_items-number">1.1.2.</span> <span class="toc_mobile_items-text">非对称加密算法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Diffie-Hellman-Key-exchange"><span class="toc_mobile_items-number">1.1.3.</span> <span class="toc_mobile_items-text">Diffie-Hellman Key exchange</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#非对称算法的具体实现-RSA算法"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">非对称算法的具体实现-RSA算法</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#RSA算法原理"><span class="toc_mobile_items-number">1.2.1.</span> <span class="toc_mobile_items-text">RSA算法原理</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#非对称算法的应用"><span class="toc_mobile_items-number">1.3.</span> <span class="toc_mobile_items-text">非对称算法的应用</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#非对称加密的安全隐患"><span class="toc_mobile_items-number">1.3.1.</span> <span class="toc_mobile_items-text">非对称加密的安全隐患</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#CA"><span class="toc_mobile_items-number">1.3.2.</span> <span class="toc_mobile_items-text">CA</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#SSL"><span class="toc_mobile_items-number">1.3.3.</span> <span class="toc_mobile_items-text">SSL</span></a></li></ol></li></ol></li></ol></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#非对称加密算法"><span class="toc-number">1.</span> <span class="toc-text">非对称加密算法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#原理"><span class="toc-number">1.1.</span> <span class="toc-text">原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#对称加密算法"><span class="toc-number">1.1.1.</span> <span class="toc-text">对称加密算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#非对称加密算法-1"><span class="toc-number">1.1.2.</span> <span class="toc-text">非对称加密算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Diffie-Hellman-Key-exchange"><span class="toc-number">1.1.3.</span> <span class="toc-text">Diffie-Hellman Key exchange</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#非对称算法的具体实现-RSA算法"><span class="toc-number">1.2.</span> <span class="toc-text">非对称算法的具体实现-RSA算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA算法原理"><span class="toc-number">1.2.1.</span> <span class="toc-text">RSA算法原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#非对称算法的应用"><span class="toc-number">1.3.</span> <span class="toc-text">非对称算法的应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#非对称加密的安全隐患"><span class="toc-number">1.3.1.</span> <span class="toc-text">非对称加密的安全隐患</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CA"><span class="toc-number">1.3.2.</span> <span class="toc-text">CA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL"><span class="toc-number">1.3.3.</span> <span class="toc-text">SSL</span></a></li></ol></li></ol></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png)"><div id="post-info"><div id="post-title"><div class="posttitle">非对称加密算法</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2021-11-19<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2021-11-20</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a></span><div class="post-meta-wordcount"><i class="fa fa-eye post-meta__icon" aria-hidden="true">       </i><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="非对称加密算法"><a href="#非对称加密算法" class="headerlink" title="非对称加密算法"></a>非对称加密算法</h1><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><h3 id="对称加密算法"><a href="#对称加密算法" class="headerlink" title="对称加密算法"></a>对称加密算法</h3><p>在了解非对称加密算法之前，我们先看一下对称加密算法。对称加密算法就是传统的用一个密码来对文件、文档进行加密和解密的算法。也就是说，通过这个密钥，我们可以把数据加密，当我们需要使用这个数据，从而对其进行解密的时候，我们使用的解密的密钥同加密的密钥一样。加密和解密的密钥相同，我们称之为对称加密算法。从程序上看，它就是一个接受message和key的函数，然后输出的是加密后的密文。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secret = encrypt(Key,message);</span><br></pre></td></tr></table></figure>
<p>而解密则相反，它接收密码和密文，然后输出我们需要的明文。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plain = decrypt(Key,secret);</span><br></pre></td></tr></table></figure>
<p>现在常用的对称加密算法有：</p>
<ul>
<li>DES:密钥长度 56/64</li>
<li>AES:密钥长度 128/192/256</li>
<li>IDEA:密钥长度 128</li>
</ul>
<p>我们可以很容易的知道，加密强度和我们的密钥长度成正比。</p>
<p>然而，在我们平时的生活中，我们其实输入的密码的位数只有几位~十几位不等。远远没有达到这些对称加密算法的要求。例如我们在使用压缩软件给我们的文档数据进行加密的时候，我们输入的密码一般也就十位左右。当我们传入的密钥长度没有达到要求时，这些算法在处理我们传入的key时，会使用<strong>PBE(Password Based Encryption)</strong>把Key和一些随机数杂糅后计算出真正的密钥。</p>
<h3 id="非对称加密算法-1"><a href="#非对称加密算法-1" class="headerlink" title="非对称加密算法"></a>非对称加密算法</h3><p>在上面的对称加密算法中，我们可以看到，由于加密和解密使用的Key是相同的，所以这让暴力破解成为了可能。而且Key的传输和保存也是一个大问题。那么非对称加密算法就出现了。</p>
<p><strong>非对称式密码学</strong>也称之为 <strong>公开密钥密码学（Public-key cryptography）</strong>。是密码学的一种算法，它和对称加密算法最大的不同就是它加密使用一个密钥，解密使用另外一个密钥。我们把用于给文件加密使用的密钥称之为<strong>公钥</strong>。而我们用于解密的密钥称之为<strong>私钥</strong>。</p>
<p><strong>加密与解密过程</strong></p>
<ul>
<li>Alice 现在需要透过不安全的互联网向 Bob 发送信息。</li>
<li>Alice 撰写好原文——$x$ 之后，由于没有加密，所以不能发出。</li>
<li>Bob使用密码学安全伪随机数生成器产生一对密钥，其中一个作为公钥为 $c$，另一个作为私钥 $d$ 。</li>
<li>Bob可以通过任何方法把公钥$c$给Alice。不用担心公钥被泄密。</li>
<li>Alice用得到的公钥$c$加密自己的原文$x$，得到密文$c(x)$。</li>
<li>Alice把密文$c(x)$通过任何方法发送给Bob。</li>
<li>Bob收到密文，用私钥$d$对密文进行解密 $d(c(x))$，得到Alice撰写的明文$x$</li>
<li>即使公钥和密文都被窃听了，但是由于没有私钥，还是不能对密文进行解密。</li>
</ul>
<p><img alt data-src="https://xinyubucket.oss-cn-beijing.aliyuncs.com/img/非对称加密流程.png" class="lazyload"></p>
<h3 id="Diffie-Hellman-Key-exchange"><a href="#Diffie-Hellman-Key-exchange" class="headerlink" title="Diffie-Hellman Key exchange"></a>Diffie-Hellman Key exchange</h3><p>非对称加密算法可以追溯到1976年的<strong>Diffie-Hellman Key exchange</strong>。这个是一种可以在双方没有任何预先信息的条件下通过不安全的信道传输非密钥的数据而建立起双方同时使用的一个密钥，并用此密钥来实现对称加密的方法。这样就避免了密钥直接在不安全的网络中传输的过程。</p>
<p>它的具体过程如下：</p>
<p><img alt data-src="https://xinyubucket.oss-cn-beijing.aliyuncs.com/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E6%96%87%E4%BB%B6_%281%29.png" class="lazyload"></p>
<p>我们可以看到，Alice : $Key = B^a \bmod p = (g^b \bmod p)^a\bmod p$。而Bob:$Key = A^b\bmod p = (g^a\bmod p)^b\bmod p$。而可以证明，$（g^b\bmod p)^a\bmod p = (g^a\bmod p)^b\bmod p$。同时，我们注意到，由于$a$和$b$的值是没有在网络上进行传播的。所以单独获取到$A,g,p,B$的值，当其足够大时，是没有办法通过暴力计算的方法来求出Key的。如果$p$是一个至少 300 位的质数，并且<em>a</em>和<em>b</em>至少有100位长，那么即使使用全人类所有的计算资源和当今最好的算法也不可能从$g$, $p$和$g^a\bmod p$中计算出 $a$。但是<strong>Diffie-Hellman Key exchange</strong>本身并没有提供通讯双方的身份验证服务，因此它很容易受到中间人攻击。 一个中间人在信道的中央进行两次<strong>Diffie-Hellman Key exchange</strong>，一次和Alice另一次和Bob，就能够成功的向Alice假装自己是Bob，反之亦然。而攻击者可以解密（读取和存储）任何一个人的信息并重新加密信息，然后传递给另一个人。因此通常都需要一个能够验证通讯双方身份的机制来防止这类攻击。</p>
<h2 id="非对称算法的具体实现-RSA算法"><a href="#非对称算法的具体实现-RSA算法" class="headerlink" title="非对称算法的具体实现-RSA算法"></a>非对称算法的具体实现-RSA算法</h2><p>1977年，三位数学家Rivest、Shamir 和 Adleman 设计了一种算法，可以实现非对称加密。这种算法用他们三个人的名字命名，叫做RSA算法。从那时直到现在，RSA算法一直是最广为使用的”非对称加密算法”。毫不夸张地说，只要有计算机网络的地方，就有RSA算法。这种算法非常可靠，密钥越长，它就越难破解。根据已经披露的文献，目前被破解的最长RSA密钥是232个十进制位，也就是768个二进制位，因此可以认为，1024位的RSA密钥基本安全，2048位的密钥极其安全。</p>
<h3 id="RSA算法原理"><a href="#RSA算法原理" class="headerlink" title="RSA算法原理"></a>RSA算法原理</h3><p>首先需要先了解一点基础的<a href="https://jeremykun.com/2011/07/30/number-theory-a-primer/" target="_blank" rel="noopener">数论知识</a>：</p>
<ul>
<li>素数(质数):大于1的自然数中，只能被自己和1整除的数。</li>
<li>互质：N个整数的最大公因子是1，则称这N个整数互质。</li>
<li>同余：当两个整数除以同一个正整数，得到了相同余数，则这两个正整数同余。</li>
</ul>
<p><strong>欧拉函数</strong></p>
<p>给定正整数n,在小于等于n的正整数之中，有多少个与n构成互质关系的数？</p>
<p>欧拉函数$\varphi(n)$表示其个数。例如计算8的欧拉函数，和8互质的 1~8中，有1，3，5，7和8互质。所以$\varphi(8) = 4$。</p>
<ul>
<li><strong>如果n是质数的某一个次方，即 n = p^k (p为质数，k为大于等于1的整数)，则φ(n) = φ(p^k) = p^k - p^(k-1)。也就是φ(8) = φ(2^3) =2^3 - 2^2 = 8 -4 = 4</strong></li>
<li><strong>如果n是质数，则 φ(n)=n-1 。因为质数与小于它的每一个数，都构成互质关系。比如5与1、2、3、4都构成互质关系。</strong></li>
<li><strong>如果n可以分解成两个互质的整数之积，即 n = p <em> k ，则φ(n) = φ(p </em> k) = φ(p1)<em>φ(p2)。例如φ(56) = φ(8) </em> φ(7) = 4 * 6 = 24</strong></li>
</ul>
<p><strong>欧拉定理</strong></p>
<p>如果两个正整数$m$和$n$互质，那么</p>
<p>​                                                                                             $m^{\varphi(n)}\bmod n \equiv 1 \qquad\qquad\qquad[1] $</p>
<p> 也就是说，$m^{\varphi(n)}-1$ 可以被n整除。</p>
<p><strong>模反元素</strong></p>
<p>如果两个正整数$e$和$x$ 互质，那么一定可以找到整数$d$，使得</p>
<p>​                                                                                             ${e*d }\ \bmod\ x \equiv 1 \qquad \qquad \qquad [2]$</p>
<p>也就是说，$e*d -1$ 可以被$x$整除。或者说</p>
<p>​                                                                                              $ e<em>d \equiv k</em>x+1\qquad \qquad \qquad [3]$</p>
<p>那么$d$就是$e$相对于$x$的模反元素。</p>
<p>当我们再对欧拉定理进行一下变形：</p>
<p>​                                                                                       $m^{k*\varphi (n)+1}\bmod n\equiv m \qquad\qquad\qquad[4]$</p>
<p>我们把$\varphi(n)$的值令为$x$的值，即$e$和$\varphi(n)$互质的时候，我们就可以把[4]方程改写为：</p>
<p>​                                                                                            $m^{e*d}\bmod n\equiv m \qquad\qquad\qquad[5]$</p>
<p>我们使用这种方法来进行加密和解密，即m 的 e乘上d 次方为加密运算，得到结果 c，c 模以 n 为解密运算，得到结果 m。这似乎可以用于加密和解密。但这样，加密的结果会非常大。明文数据将非常小。</p>
<p>当我们再回顾之前所提到的<strong>Diffie-Hellman Key exchange。</strong>之前提到$(g^b \bmod p)^a\bmod p = (g^a \bmod p)^b\bmod p$，双方能得到相同的Key。当我们换一个思路，把$(g^a \bmod p)$看作加密之后的密文，把$b$看作解密所需要的密钥，我们就发现，我们加密所用的<strong>$a$</strong>和解密所用的$b$不是同一个数。让我们试着把[5]式拆分一下：</p>
<p>​                                                                                                  $m^e \bmod n = C\\C^d\bmod n = m$</p>
<p>我们可以看到，当我们把 $m$看作明文，把$C$看作加密之后的密文，传输过去后，对方只需要知道$d$和$n$的值，对方就可以获取明文$m$。而我们用来加密$m$的是$e和n$。也就是说，我们可以把$e$和$n$当作public Key。用于对方给我们发送消息时的加密。而把$d$看作private Key。由于私钥自始至终都存放在本地，而没有外泄。所以也就没有了泄露的风险。加密时我们也要知道φ(n)的值，最简单的方式是用两个质数之积得到，别人想破解RSA也要知道φ(n)的值，只能对n进行因数分解，那么我们不想m被破解，n的值就要非常大，就是我们之前说的，长度一般为1024个二进制位，这样就比较安全了。2048位就很安全了。(但是现在量子计算机的出现也许会打破这个准则。)</p>
<h2 id="非对称算法的应用"><a href="#非对称算法的应用" class="headerlink" title="非对称算法的应用"></a>非对称算法的应用</h2><p>其实非对称算法不仅仅只有RSA算法，但是其他算法的核心思想也和RSA算法大同小异。所以我们在这里就不再谈论其他算法了。RSA算法也是大量应用在日常互联网的生活中。例如HTTPS网页的访问、PGP加密软件的使用等。</p>
<h3 id="非对称加密的安全隐患"><a href="#非对称加密的安全隐患" class="headerlink" title="非对称加密的安全隐患"></a>非对称加密的安全隐患</h3><p>在说SSL之前，我们还需要看一下非对称加密的不足性。在一切的最开始，由于A,B不是单方面的通信，所以A和B要通过网络交换public key。如果C在中间拦截了呢？假设有这种情况，C拦截了A和B的public key，又分别用自己的public key发给A和B。A和B并不知道，他们还以为这个public key来自对方。当A给B发消息时，A先用自己的private key加密数据的hash值，之后用C传来的假的public key加密数据，再发出去。C拦截到之后，先用C自己的private key解密数据，C就获取了A的原始信息！之后，C可以篡改数据内容，再用自己的private key加密数据的hash值，用之前拦截的B的public key加密数据，再发给B。B收到以后，先用自己的private key解密数据，再用C传来的假public key解密hash值，发现匹配。这样，B收到了一条来自C的假的信息，但是B还以为信息来自于A。中间人攻击仍然可能存在</p>
<p><img alt data-src="https://xinyubucket.oss-cn-beijing.aliyuncs.com/img/隐患.png" class="lazyload"></p>
<h3 id="CA"><a href="#CA" class="headerlink" title="CA"></a>CA</h3><p>这个时候，我们就需要<strong>CA（Certificate Authority）</strong>这个机构的存在了。他们的作用就是保证public Key 的真实性。CA也是基于非对称加密算法来工作。有了CA，B会先把自己的public key（和一些其他信息）交给CA。CA用自己的private key加密这些数据，加密完的数据称为B的数字证书。(使用private  Key 加密也称之为<strong>签名</strong>。因为加密之后，内容如果在传输途中被拦截并使用其public Key解密。则由于劫持方没有你的private Key，他不能再把原文进行加密。从而达到<strong>确认传输的内容没有被修改的目的</strong>)现在B要向A传递public key，B传递的是CA加密之后的数字证书。A收到以后，会通过CA发布的CA证书（包含了CA的public key），来解密B的数字证书，从而获得B的public key。CA把自己的CA证书集成在了浏览器和操作系统里面。A拿到浏览器或者操作系统的时候，已经有了CA证书，没有必要通过网络获取，那自然也不存在劫持的问题。</p>
<p>现在A和B都有了CA认证的数字证书。在交换public key的阶段，直接交换彼此的数字证书就行。而中间人C，还是可以拦截A和B的public key，也可以用CA证书解密获得A和B的public key。但是，C没有办法伪造public key了。因为C不在CA体系里面，C没有CA的private key，所以C是没有办法伪造出一个可以通过CA认证的数字证书。如果不能通过CA认证，A和B自然也不会相信这个伪造的证书。所以，采用CA认证以后，A和B的public key的真实性得到了保证，A和B可以通过网络交换public key（实际是被CA加密之后的数字证书）。</p>
<h3 id="SSL"><a href="#SSL" class="headerlink" title="SSL"></a>SSL</h3><p>现在我们每天访问的大量网站中，基本都是HTTPS（Hyper Text Transfer Protocol Secure）网页，以前，我们的网页都是HTTP（Hyper Text Transfer Protocol）。这个传输协议是不安全的。传输的过程中，各种信息都有可能被泄露。而HTTPS网页就是使用的SSL(Secure Socket Layer)或者TLS(Transport Layer Security)(后者比较新，但我们一般使用SSL统称这两个)。</p>
<p>其具体流程如下：</p>
<ul>
<li>通过CA体系交换public key</li>
<li>通过非对称加密算法(例如RSA算法)交换用于对称加密的密钥</li>
<li>通过对称加密算法，加密正常的网络通信</li>
</ul>
<p>非对称加密算法比对称加密算法要复杂的多，处理起来也要慢得多。如果所有的网络数据都用非对称加密算法来加密，那效率会很低。所以在实际中，非对称加密只会用来传递一条信息，那就是用于对称加密的密钥。当用于对称加密的密钥确定了，A和B还是通过对称加密算法进行网络通信。这样，既保证了网络通信的安全性，又不影响效率。</p>
<p><img alt data-src="https://xinyubucket.oss-cn-beijing.aliyuncs.com/img/Untitled.png" class="lazyload"></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined" target="_blank" rel="noopener">Dr-xinyu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://dr-xinyu.github.io/2021/11/19/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/">https://dr-xinyu.github.io/2021/11/19/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://Dr-xinyu.github.io">心雨</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AD%A6%E4%B9%A0/">学习    </a><a class="post-meta__tags" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学    </a><a class="post-meta__tags" href="/tags/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/">非对称加密算法    </a><a class="post-meta__tags" href="/tags/RSA%E7%AE%97%E6%B3%95/">RSA算法    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button"><i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="next-post pull-full"><a href="/2021/04/26/%E5%8D%97%E4%BA%AC/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>南京之旅</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2021/01/10/2020总结/" title="迟到的总结"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">迟到的总结</div></a></div><div class="relatedPosts_item"><a href="/2019/11/08/JAVA/" title="JAVA"><img class="relatedPosts_cover lazyload"data-src="https://xinyubucket.oss-cn-beijing.aliyuncs.com/img/java.jpg"><div class="relatedPosts_title">JAVA</div></a></div><div class="relatedPosts_item"><a href="/2020/10/27/JavaSpring/" title="Spring"><img class="relatedPosts_cover lazyload"data-src="https://xinyubucket.oss-cn-beijing.aliyuncs.com/img/fengmian/%E9%87%91%E5%85%8B%E6%96%AF.png"><div class="relatedPosts_title">Spring</div></a></div><div class="relatedPosts_item"><a href="/2020/12/07/Mybatis/" title="Mybatis"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">Mybatis</div></a></div><div class="relatedPosts_item"><a href="/2020/11/13/javaWeb/" title="JavaWeb"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">JavaWeb</div></a></div><div class="relatedPosts_item"><a href="/2020/10/29/xml文档/" title="XML文档"><img class="relatedPosts_cover lazyload"data-src="https://xinyubucket.oss-cn-beijing.aliyuncs.com/img/fengmian/4.jpg"><div class="relatedPosts_title">XML文档</div></a></div></div><div class="clear_both"></div></div></div></div><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By Dr-xinyu</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="/js/third-party/canvas-nest.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true; // make power mode colorful
POWERMODE.shake = true; // turn off shake
document.body.addEventListener('input', POWERMODE);
</script><script src="/js/tw_cn.js"></script><script>translateInitilization()
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>